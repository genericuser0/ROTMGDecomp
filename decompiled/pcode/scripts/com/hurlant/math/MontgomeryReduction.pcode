package com.hurlant.math
{
   use namespace bi_internal;
   
   class MontgomeryReduction implements IReduction
   {
      
      {
         method
         name null
         returns null
         
         body
         maxstack 1
         localcount 1
         initscopedepth 3
         maxscopedepth 4
         
         code
         getlocal_0
         pushscope
         returnvoid
         end ; code
         end ; body
         end ; method
      }
      
      private var m:BigInteger;
      
      private var mp:int;
      
      private var mpl:int;
      
      private var mph:int;
      
      private var um:int;
      
      private var mt2:int;
      
      function MontgomeryReduction(param1:BigInteger)
      {
         method
         name null
         param Qname(PackageNamespace("com.hurlant.math"),"BigInteger")
         returns null
         
         body
         maxstack 4
         localcount 2
         initscopedepth 4
         maxscopedepth 5
         
         code
         getlocal_0
         pushscope
         getlocal_0
         constructsuper 0
         getlocal_0
         getlocal_1
         initproperty Qname(PrivateNamespace(null,"1183"),"m")
         getlocal_0
         getlocal_1
         callproperty Qname(Namespace("http://crypto.hurlant.com/BigInteger"),"invDigit") 0
         initproperty Qname(PrivateNamespace(null,"1183"),"mp")
         getlocal_0
         getlocal_0
         getproperty Qname(PrivateNamespace(null,"1183"),"mp")
         pushshort 32767
         bitand
         initproperty Qname(PrivateNamespace(null,"1183"),"mpl")
         getlocal_0
         getlocal_0
         getproperty Qname(PrivateNamespace(null,"1183"),"mp")
         pushbyte 15
         rshift
         initproperty Qname(PrivateNamespace(null,"1183"),"mph")
         getlocal_0
         pushbyte 1
         getlex Qname(PackageNamespace("com.hurlant.math"),"BigInteger")
         getproperty Qname(PackageNamespace(""),"DB")
         pushbyte 15
         subtract
         lshift
         decrement
         initproperty Qname(PrivateNamespace(null,"1183"),"um")
         getlocal_0
         pushbyte 2
         getlocal_1
         getproperty Qname(PackageNamespace(""),"t")
         multiply
         initproperty Qname(PrivateNamespace(null,"1183"),"mt2")
         returnvoid
         end ; code
         end ; body
         end ; method
      }
      
      public function convert(param1:BigInteger) : BigInteger
      {
         trait method Qname(PackageNamespace(""),"convert")
         dispid 0
         method
         name null
         param Qname(PackageNamespace("com.hurlant.math"),"BigInteger")
         returns Qname(PackageNamespace("com.hurlant.math"),"BigInteger")
         
         body
         maxstack 4
         localcount 3
         initscopedepth 4
         maxscopedepth 5
         
         code
         getlocal_0
         pushscope
         findpropstrict Qname(PackageNamespace("com.hurlant.math"),"BigInteger")
         constructprop Qname(PackageNamespace("com.hurlant.math"),"BigInteger") 0
         coerce Qname(PackageNamespace("com.hurlant.math"),"BigInteger")
         setlocal_2
         getlocal_1
         callproperty Qname(PackageNamespace(""),"abs") 0
         getlocal_0
         getproperty Qname(PrivateNamespace(null,"1183"),"m")
         getproperty Qname(PackageNamespace(""),"t")
         getlocal_2
         callpropvoid Qname(Namespace("http://crypto.hurlant.com/BigInteger"),"dlShiftTo") 2
         getlocal_2
         getlocal_0
         getproperty Qname(PrivateNamespace(null,"1183"),"m")
         pushnull
         getlocal_2
         callpropvoid Qname(Namespace("http://crypto.hurlant.com/BigInteger"),"divRemTo") 3
         getlocal_1
         getproperty Qname(Namespace("http://crypto.hurlant.com/BigInteger"),"s")
         pushbyte 0
         lessthan
         dup
         iffalse ofs0045
         pop
         getlocal_2
         getlex Qname(PackageNamespace("com.hurlant.math"),"BigInteger")
         getproperty Qname(PackageNamespace(""),"ZERO")
         callproperty Qname(PackageNamespace(""),"compareTo") 1
         pushbyte 0
         greaterthan
         ofs0045:iffalse ofs0053
         getlocal_0
         getproperty Qname(PrivateNamespace(null,"1183"),"m")
         getlocal_2
         getlocal_2
         callpropvoid Qname(Namespace("http://crypto.hurlant.com/BigInteger"),"subTo") 2
         ofs0053:getlocal_2
         returnvalue
         end ; code
         end ; body
         end ; method
      }
      
      public function revert(param1:BigInteger) : BigInteger
      {
         trait method Qname(PackageNamespace(""),"revert")
         dispid 0
         method
         name null
         param Qname(PackageNamespace("com.hurlant.math"),"BigInteger")
         returns Qname(PackageNamespace("com.hurlant.math"),"BigInteger")
         
         body
         maxstack 2
         localcount 3
         initscopedepth 4
         maxscopedepth 5
         
         code
         getlocal_0
         pushscope
         findpropstrict Qname(PackageNamespace("com.hurlant.math"),"BigInteger")
         constructprop Qname(PackageNamespace("com.hurlant.math"),"BigInteger") 0
         coerce Qname(PackageNamespace("com.hurlant.math"),"BigInteger")
         setlocal_2
         getlocal_1
         getlocal_2
         callpropvoid Qname(Namespace("http://crypto.hurlant.com/BigInteger"),"copyTo") 1
         getlocal_0
         getlocal_2
         callpropvoid Qname(PackageNamespace(""),"reduce") 1
         getlocal_2
         returnvalue
         end ; code
         end ; body
         end ; method
      }
      
      public function reduce(param1:BigInteger) : void
      {
         trait method Qname(PackageNamespace(""),"reduce")
         dispid 0
         method
         name null
         param Qname(PackageNamespace("com.hurlant.math"),"BigInteger")
         returns Qname(PackageNamespace(""),"void")
         
         body
         maxstack 10
         localcount 8
         initscopedepth 4
         maxscopedepth 5
         
         code
         getlocal_0
         pushscope
         pushbyte 0
         setlocal_3
         pushbyte 0
         setlocal 4
         jump ofs0033
         ofs000d:label
         getlocal_1
         getproperty Qname(Namespace("http://crypto.hurlant.com/BigInteger"),"a")
         getlocal_1
         dup
         setlocal 6
         getproperty Qname(PackageNamespace(""),"t")
         dup
         increment_i
         setlocal 7
         getlocal 6
         getlocal 7
         setproperty Qname(PackageNamespace(""),"t")
         kill 7
         kill 6
         dup
         setlocal 5
         pushbyte 0
         setproperty MultinameL([PrivateNamespace(null,"1183"),Namespace("http://crypto.hurlant.com/BigInteger"),PackageNamespace("com.hurlant.math"),PackageNamespace(""),PrivateNamespace(null,"2111"),PackageInternalNs("com.hurlant.math"),Namespace("http://adobe.com/AS3/2006/builtin"),ProtectedNamespace("com.hurlant.math:MontgomeryReduction"),StaticProtectedNs("com.hurlant.math:MontgomeryReduction")])
         kill 5
         ofs0033:getlocal_1
         getproperty Qname(PackageNamespace(""),"t")
         getlocal_0
         getproperty Qname(PrivateNamespace(null,"1183"),"mt2")
         ifle ofs000d
         pushbyte 0
         setlocal_2
         jump ofs0117
         ofs0046:label
         getlocal_1
         getproperty Qname(Namespace("http://crypto.hurlant.com/BigInteger"),"a")
         getlocal_2
         getproperty MultinameL([PrivateNamespace(null,"1183"),Namespace("http://crypto.hurlant.com/BigInteger"),PackageNamespace("com.hurlant.math"),PackageNamespace(""),PrivateNamespace(null,"2111"),PackageInternalNs("com.hurlant.math"),Namespace("http://adobe.com/AS3/2006/builtin"),ProtectedNamespace("com.hurlant.math:MontgomeryReduction"),StaticProtectedNs("com.hurlant.math:MontgomeryReduction")])
         pushshort 32767
         bitand
         setlocal_3
         getlocal_3
         getlocal_0
         getproperty Qname(PrivateNamespace(null,"1183"),"mpl")
         multiply
         getlocal_3
         getlocal_0
         getproperty Qname(PrivateNamespace(null,"1183"),"mph")
         multiply
         getlocal_1
         getproperty Qname(Namespace("http://crypto.hurlant.com/BigInteger"),"a")
         getlocal_2
         getproperty MultinameL([PrivateNamespace(null,"1183"),Namespace("http://crypto.hurlant.com/BigInteger"),PackageNamespace("com.hurlant.math"),PackageNamespace(""),PrivateNamespace(null,"2111"),PackageInternalNs("com.hurlant.math"),Namespace("http://adobe.com/AS3/2006/builtin"),ProtectedNamespace("com.hurlant.math:MontgomeryReduction"),StaticProtectedNs("com.hurlant.math:MontgomeryReduction")])
         pushbyte 15
         rshift
         getlocal_0
         getproperty Qname(PrivateNamespace(null,"1183"),"mpl")
         multiply
         add
         getlocal_0
         getproperty Qname(PrivateNamespace(null,"1183"),"um")
         bitand
         pushbyte 15
         lshift
         add
         getlex Qname(PackageNamespace("com.hurlant.math"),"BigInteger")
         getproperty Qname(PackageNamespace(""),"DM")
         bitand
         setlocal 4
         getlocal_2
         getlocal_0
         getproperty Qname(PrivateNamespace(null,"1183"),"m")
         getproperty Qname(PackageNamespace(""),"t")
         add
         convert_i
         setlocal_3
         getlocal_1
         getproperty Qname(Namespace("http://crypto.hurlant.com/BigInteger"),"a")
         getlocal_3
         getlocal_1
         getproperty Qname(Namespace("http://crypto.hurlant.com/BigInteger"),"a")
         getlocal_3
         getproperty MultinameL([PrivateNamespace(null,"1183"),Namespace("http://crypto.hurlant.com/BigInteger"),PackageNamespace("com.hurlant.math"),PackageNamespace(""),PrivateNamespace(null,"2111"),PackageInternalNs("com.hurlant.math"),Namespace("http://adobe.com/AS3/2006/builtin"),ProtectedNamespace("com.hurlant.math:MontgomeryReduction"),StaticProtectedNs("com.hurlant.math:MontgomeryReduction")])
         getlocal_0
         getproperty Qname(PrivateNamespace(null,"1183"),"m")
         pushbyte 0
         getlocal 4
         getlocal_1
         getlocal_2
         pushbyte 0
         getlocal_0
         getproperty Qname(PrivateNamespace(null,"1183"),"m")
         getproperty Qname(PackageNamespace(""),"t")
         callproperty Qname(Namespace("http://crypto.hurlant.com/BigInteger"),"am") 6
         add
         setproperty MultinameL([PrivateNamespace(null,"1183"),Namespace("http://crypto.hurlant.com/BigInteger"),PackageNamespace("com.hurlant.math"),PackageNamespace(""),PrivateNamespace(null,"2111"),PackageInternalNs("com.hurlant.math"),Namespace("http://adobe.com/AS3/2006/builtin"),ProtectedNamespace("com.hurlant.math:MontgomeryReduction"),StaticProtectedNs("com.hurlant.math:MontgomeryReduction")])
         jump ofs0101
         ofs00c0:label
         getlocal_1
         getproperty Qname(Namespace("http://crypto.hurlant.com/BigInteger"),"a")
         getlocal_3
         getlocal_1
         getproperty Qname(Namespace("http://crypto.hurlant.com/BigInteger"),"a")
         getlocal_3
         getproperty MultinameL([PrivateNamespace(null,"1183"),Namespace("http://crypto.hurlant.com/BigInteger"),PackageNamespace("com.hurlant.math"),PackageNamespace(""),PrivateNamespace(null,"2111"),PackageInternalNs("com.hurlant.math"),Namespace("http://adobe.com/AS3/2006/builtin"),ProtectedNamespace("com.hurlant.math:MontgomeryReduction"),StaticProtectedNs("com.hurlant.math:MontgomeryReduction")])
         getlex Qname(PackageNamespace("com.hurlant.math"),"BigInteger")
         getproperty Qname(PackageNamespace(""),"DV")
         subtract
         setproperty MultinameL([PrivateNamespace(null,"1183"),Namespace("http://crypto.hurlant.com/BigInteger"),PackageNamespace("com.hurlant.math"),PackageNamespace(""),PrivateNamespace(null,"2111"),PackageInternalNs("com.hurlant.math"),Namespace("http://adobe.com/AS3/2006/builtin"),ProtectedNamespace("com.hurlant.math:MontgomeryReduction"),StaticProtectedNs("com.hurlant.math:MontgomeryReduction")])
         getlocal_1
         getproperty Qname(Namespace("http://crypto.hurlant.com/BigInteger"),"a")
         dup
         setlocal 5
         getlocal_3
         increment_i
         dup
         convert_i
         setlocal_3
         dup
         setlocal 6
         getproperty MultinameL([PrivateNamespace(null,"1183"),Namespace("http://crypto.hurlant.com/BigInteger"),PackageNamespace("com.hurlant.math"),PackageNamespace(""),PrivateNamespace(null,"2111"),PackageInternalNs("com.hurlant.math"),Namespace("http://adobe.com/AS3/2006/builtin"),ProtectedNamespace("com.hurlant.math:MontgomeryReduction"),StaticProtectedNs("com.hurlant.math:MontgomeryReduction")])
         increment
         setlocal 7
         getlocal 5
         getlocal 6
         getlocal 7
         setproperty MultinameL([PrivateNamespace(null,"1183"),Namespace("http://crypto.hurlant.com/BigInteger"),PackageNamespace("com.hurlant.math"),PackageNamespace(""),PrivateNamespace(null,"2111"),PackageInternalNs("com.hurlant.math"),Namespace("http://adobe.com/AS3/2006/builtin"),ProtectedNamespace("com.hurlant.math:MontgomeryReduction"),StaticProtectedNs("com.hurlant.math:MontgomeryReduction")])
         kill 7
         kill 5
         kill 6
         ofs0101:getlocal_1
         getproperty Qname(Namespace("http://crypto.hurlant.com/BigInteger"),"a")
         getlocal_3
         getproperty MultinameL([PrivateNamespace(null,"1183"),Namespace("http://crypto.hurlant.com/BigInteger"),PackageNamespace("com.hurlant.math"),PackageNamespace(""),PrivateNamespace(null,"2111"),PackageInternalNs("com.hurlant.math"),Namespace("http://adobe.com/AS3/2006/builtin"),ProtectedNamespace("com.hurlant.math:MontgomeryReduction"),StaticProtectedNs("com.hurlant.math:MontgomeryReduction")])
         getlex Qname(PackageNamespace("com.hurlant.math"),"BigInteger")
         getproperty Qname(PackageNamespace(""),"DV")
         ifge ofs00c0
         inclocal_i 2
         ofs0117:getlocal_2
         getlocal_0
         getproperty Qname(PrivateNamespace(null,"1183"),"m")
         getproperty Qname(PackageNamespace(""),"t")
         iflt ofs0046
         getlocal_1
         callpropvoid Qname(Namespace("http://crypto.hurlant.com/BigInteger"),"clamp") 0
         getlocal_1
         getlocal_0
         getproperty Qname(PrivateNamespace(null,"1183"),"m")
         getproperty Qname(PackageNamespace(""),"t")
         getlocal_1
         callpropvoid Qname(Namespace("http://crypto.hurlant.com/BigInteger"),"drShiftTo") 2
         getlocal_1
         getlocal_0
         getproperty Qname(PrivateNamespace(null,"1183"),"m")
         callproperty Qname(PackageNamespace(""),"compareTo") 1
         pushbyte 0
         ifnge ofs014e
         getlocal_1
         getlocal_0
         getproperty Qname(PrivateNamespace(null,"1183"),"m")
         getlocal_1
         callpropvoid Qname(Namespace("http://crypto.hurlant.com/BigInteger"),"subTo") 2
         ofs014e:returnvoid
         end ; code
         end ; body
         end ; method
      }
      
      public function sqrTo(param1:BigInteger, param2:BigInteger) : void
      {
         trait method Qname(PackageNamespace(""),"sqrTo")
         dispid 0
         method
         name null
         param Qname(PackageNamespace("com.hurlant.math"),"BigInteger")
         param Qname(PackageNamespace("com.hurlant.math"),"BigInteger")
         returns Qname(PackageNamespace(""),"void")
         
         body
         maxstack 2
         localcount 3
         initscopedepth 4
         maxscopedepth 5
         
         code
         getlocal_0
         pushscope
         getlocal_1
         getlocal_2
         callpropvoid Qname(Namespace("http://crypto.hurlant.com/BigInteger"),"squareTo") 1
         getlocal_0
         getlocal_2
         callpropvoid Qname(PackageNamespace(""),"reduce") 1
         returnvoid
         end ; code
         end ; body
         end ; method
      }
      
      public function mulTo(param1:BigInteger, param2:BigInteger, param3:BigInteger) : void
      {
         trait method Qname(PackageNamespace(""),"mulTo")
         dispid 0
         method
         name null
         param Qname(PackageNamespace("com.hurlant.math"),"BigInteger")
         param Qname(PackageNamespace("com.hurlant.math"),"BigInteger")
         param Qname(PackageNamespace("com.hurlant.math"),"BigInteger")
         returns Qname(PackageNamespace(""),"void")
         
         body
         maxstack 3
         localcount 4
         initscopedepth 4
         maxscopedepth 5
         
         code
         getlocal_0
         pushscope
         getlocal_1
         getlocal_2
         getlocal_3
         callpropvoid Qname(Namespace("http://crypto.hurlant.com/BigInteger"),"multiplyTo") 2
         getlocal_0
         getlocal_3
         callpropvoid Qname(PackageNamespace(""),"reduce") 1
         returnvoid
         end ; code
         end ; body
         end ; method
      }
   }
}
