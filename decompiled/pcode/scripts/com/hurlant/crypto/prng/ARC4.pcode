package com.hurlant.crypto.prng
{
   import com.hurlant.crypto.symmetric.IStreamCipher;
   import com.hurlant.util.Memory;
   import flash.utils.ByteArray;
   
   public class ARC4 implements IPRNG, IStreamCipher
   {
      
      {
         method
         name null
         returns null
         
         body
         maxstack 1
         localcount 1
         initscopedepth 3
         maxscopedepth 4
         
         code
         getlocal_0
         pushscope
         returnvoid
         end ; code
         end ; body
         end ; method
      }
      
      private var i:int = 0;
      
      private var j:int = 0;
      
      private var S:ByteArray;
      
      private const psize:uint = 256;
      
      public function ARC4(param1:ByteArray = null)
      {
         method
         name null
         flag HAS_OPTIONAL
         param Qname(PackageNamespace("flash.utils"),"ByteArray")
         optional null
         returns null
         
         body
         maxstack 2
         localcount 2
         initscopedepth 4
         maxscopedepth 5
         
         code
         getlocal_0
         pushscope
         getlocal_0
         constructsuper 0
         getlocal_0
         findpropstrict Qname(PackageNamespace("flash.utils"),"ByteArray")
         constructprop Qname(PackageNamespace("flash.utils"),"ByteArray") 0
         initproperty Qname(PrivateNamespace(null,"1128"),"S")
         getlocal_1
         iffalse ofs001b
         getlocal_0
         getlocal_1
         callpropvoid Qname(PackageNamespace(""),"init") 1
         ofs001b:returnvoid
         end ; code
         end ; body
         end ; method
      }
      
      public function getPoolSize() : uint
      {
         trait method Qname(PackageNamespace(""),"getPoolSize")
         dispid 0
         method
         name null
         returns Qname(PackageNamespace(""),"uint")
         
         body
         maxstack 1
         localcount 1
         initscopedepth 4
         maxscopedepth 5
         
         code
         getlocal_0
         pushscope
         getlocal_0
         getproperty Qname(PrivateNamespace(null,"1128"),"psize")
         returnvalue
         end ; code
         end ; body
         end ; method
      }
      
      public function init(param1:ByteArray) : void
      {
         trait method Qname(PackageNamespace(""),"init")
         dispid 0
         method
         name null
         param Qname(PackageNamespace("flash.utils"),"ByteArray")
         returns Qname(PackageNamespace(""),"void")
         
         body
         maxstack 4
         localcount 5
         initscopedepth 4
         maxscopedepth 5
         
         code
         getlocal_0
         pushscope
         pushbyte 0
         setlocal_2
         pushbyte 0
         setlocal_3
         pushbyte 0
         setlocal 4
         pushbyte 0
         setlocal_2
         jump ofs0020
         ofs0013:label
         getlocal_0
         getproperty Qname(PrivateNamespace(null,"1128"),"S")
         getlocal_2
         getlocal_2
         setproperty MultinameL([PrivateNamespace(null,"1128"),PackageNamespace(""),PrivateNamespace(null,"2063"),PackageNamespace("com.hurlant.crypto.prng"),PackageInternalNs("com.hurlant.crypto.prng"),Namespace("http://adobe.com/AS3/2006/builtin"),ProtectedNamespace("com.hurlant.crypto.prng:ARC4"),StaticProtectedNs("com.hurlant.crypto.prng:ARC4")])
         inclocal_i 2
         ofs0020:getlocal_2
         pushshort 256
         iflt ofs0013
         pushbyte 0
         setlocal_3
         pushbyte 0
         setlocal_2
         jump ofs007a
         ofs0032:label
         getlocal_3
         getlocal_0
         getproperty Qname(PrivateNamespace(null,"1128"),"S")
         getlocal_2
         getproperty MultinameL([PrivateNamespace(null,"1128"),PackageNamespace(""),PrivateNamespace(null,"2063"),PackageNamespace("com.hurlant.crypto.prng"),PackageInternalNs("com.hurlant.crypto.prng"),Namespace("http://adobe.com/AS3/2006/builtin"),ProtectedNamespace("com.hurlant.crypto.prng:ARC4"),StaticProtectedNs("com.hurlant.crypto.prng:ARC4")])
         add
         getlocal_1
         getlocal_2
         getlocal_1
         getproperty Qname(PackageNamespace(""),"length")
         modulo
         getproperty MultinameL([PrivateNamespace(null,"1128"),PackageNamespace(""),PrivateNamespace(null,"2063"),PackageNamespace("com.hurlant.crypto.prng"),PackageInternalNs("com.hurlant.crypto.prng"),Namespace("http://adobe.com/AS3/2006/builtin"),ProtectedNamespace("com.hurlant.crypto.prng:ARC4"),StaticProtectedNs("com.hurlant.crypto.prng:ARC4")])
         add
         pushshort 255
         bitand
         setlocal_3
         getlocal_0
         getproperty Qname(PrivateNamespace(null,"1128"),"S")
         getlocal_2
         getproperty MultinameL([PrivateNamespace(null,"1128"),PackageNamespace(""),PrivateNamespace(null,"2063"),PackageNamespace("com.hurlant.crypto.prng"),PackageInternalNs("com.hurlant.crypto.prng"),Namespace("http://adobe.com/AS3/2006/builtin"),ProtectedNamespace("com.hurlant.crypto.prng:ARC4"),StaticProtectedNs("com.hurlant.crypto.prng:ARC4")])
         convert_i
         setlocal 4
         getlocal_0
         getproperty Qname(PrivateNamespace(null,"1128"),"S")
         getlocal_2
         getlocal_0
         getproperty Qname(PrivateNamespace(null,"1128"),"S")
         getlocal_3
         getproperty MultinameL([PrivateNamespace(null,"1128"),PackageNamespace(""),PrivateNamespace(null,"2063"),PackageNamespace("com.hurlant.crypto.prng"),PackageInternalNs("com.hurlant.crypto.prng"),Namespace("http://adobe.com/AS3/2006/builtin"),ProtectedNamespace("com.hurlant.crypto.prng:ARC4"),StaticProtectedNs("com.hurlant.crypto.prng:ARC4")])
         setproperty MultinameL([PrivateNamespace(null,"1128"),PackageNamespace(""),PrivateNamespace(null,"2063"),PackageNamespace("com.hurlant.crypto.prng"),PackageInternalNs("com.hurlant.crypto.prng"),Namespace("http://adobe.com/AS3/2006/builtin"),ProtectedNamespace("com.hurlant.crypto.prng:ARC4"),StaticProtectedNs("com.hurlant.crypto.prng:ARC4")])
         getlocal_0
         getproperty Qname(PrivateNamespace(null,"1128"),"S")
         getlocal_3
         getlocal 4
         setproperty MultinameL([PrivateNamespace(null,"1128"),PackageNamespace(""),PrivateNamespace(null,"2063"),PackageNamespace("com.hurlant.crypto.prng"),PackageInternalNs("com.hurlant.crypto.prng"),Namespace("http://adobe.com/AS3/2006/builtin"),ProtectedNamespace("com.hurlant.crypto.prng:ARC4"),StaticProtectedNs("com.hurlant.crypto.prng:ARC4")])
         inclocal_i 2
         ofs007a:getlocal_2
         pushshort 256
         iflt ofs0032
         getlocal_0
         pushbyte 0
         setproperty Qname(PrivateNamespace(null,"1128"),"i")
         getlocal_0
         pushbyte 0
         setproperty Qname(PrivateNamespace(null,"1128"),"j")
         returnvoid
         end ; code
         end ; body
         end ; method
      }
      
      public function next() : uint
      {
         trait method Qname(PackageNamespace(""),"next")
         dispid 0
         method
         name null
         returns Qname(PackageNamespace(""),"uint")
         
         body
         maxstack 4
         localcount 2
         initscopedepth 4
         maxscopedepth 5
         
         code
         getlocal_0
         pushscope
         pushbyte 0
         setlocal_1
         getlocal_0
         getlocal_0
         getproperty Qname(PrivateNamespace(null,"1128"),"i")
         pushbyte 1
         add
         pushshort 255
         bitand
         initproperty Qname(PrivateNamespace(null,"1128"),"i")
         getlocal_0
         getlocal_0
         getproperty Qname(PrivateNamespace(null,"1128"),"j")
         getlocal_0
         getproperty Qname(PrivateNamespace(null,"1128"),"S")
         getlocal_0
         getproperty Qname(PrivateNamespace(null,"1128"),"i")
         getproperty MultinameL([PrivateNamespace(null,"1128"),PackageNamespace(""),PrivateNamespace(null,"2063"),PackageNamespace("com.hurlant.crypto.prng"),PackageInternalNs("com.hurlant.crypto.prng"),Namespace("http://adobe.com/AS3/2006/builtin"),ProtectedNamespace("com.hurlant.crypto.prng:ARC4"),StaticProtectedNs("com.hurlant.crypto.prng:ARC4")])
         add
         pushshort 255
         bitand
         initproperty Qname(PrivateNamespace(null,"1128"),"j")
         getlocal_0
         getproperty Qname(PrivateNamespace(null,"1128"),"S")
         getlocal_0
         getproperty Qname(PrivateNamespace(null,"1128"),"i")
         getproperty MultinameL([PrivateNamespace(null,"1128"),PackageNamespace(""),PrivateNamespace(null,"2063"),PackageNamespace("com.hurlant.crypto.prng"),PackageInternalNs("com.hurlant.crypto.prng"),Namespace("http://adobe.com/AS3/2006/builtin"),ProtectedNamespace("com.hurlant.crypto.prng:ARC4"),StaticProtectedNs("com.hurlant.crypto.prng:ARC4")])
         convert_i
         setlocal_1
         getlocal_0
         getproperty Qname(PrivateNamespace(null,"1128"),"S")
         getlocal_0
         getproperty Qname(PrivateNamespace(null,"1128"),"i")
         getlocal_0
         getproperty Qname(PrivateNamespace(null,"1128"),"S")
         getlocal_0
         getproperty Qname(PrivateNamespace(null,"1128"),"j")
         getproperty MultinameL([PrivateNamespace(null,"1128"),PackageNamespace(""),PrivateNamespace(null,"2063"),PackageNamespace("com.hurlant.crypto.prng"),PackageInternalNs("com.hurlant.crypto.prng"),Namespace("http://adobe.com/AS3/2006/builtin"),ProtectedNamespace("com.hurlant.crypto.prng:ARC4"),StaticProtectedNs("com.hurlant.crypto.prng:ARC4")])
         setproperty MultinameL([PrivateNamespace(null,"1128"),PackageNamespace(""),PrivateNamespace(null,"2063"),PackageNamespace("com.hurlant.crypto.prng"),PackageInternalNs("com.hurlant.crypto.prng"),Namespace("http://adobe.com/AS3/2006/builtin"),ProtectedNamespace("com.hurlant.crypto.prng:ARC4"),StaticProtectedNs("com.hurlant.crypto.prng:ARC4")])
         getlocal_0
         getproperty Qname(PrivateNamespace(null,"1128"),"S")
         getlocal_0
         getproperty Qname(PrivateNamespace(null,"1128"),"j")
         getlocal_1
         setproperty MultinameL([PrivateNamespace(null,"1128"),PackageNamespace(""),PrivateNamespace(null,"2063"),PackageNamespace("com.hurlant.crypto.prng"),PackageInternalNs("com.hurlant.crypto.prng"),Namespace("http://adobe.com/AS3/2006/builtin"),ProtectedNamespace("com.hurlant.crypto.prng:ARC4"),StaticProtectedNs("com.hurlant.crypto.prng:ARC4")])
         getlocal_0
         getproperty Qname(PrivateNamespace(null,"1128"),"S")
         getlocal_1
         getlocal_0
         getproperty Qname(PrivateNamespace(null,"1128"),"S")
         getlocal_0
         getproperty Qname(PrivateNamespace(null,"1128"),"i")
         getproperty MultinameL([PrivateNamespace(null,"1128"),PackageNamespace(""),PrivateNamespace(null,"2063"),PackageNamespace("com.hurlant.crypto.prng"),PackageInternalNs("com.hurlant.crypto.prng"),Namespace("http://adobe.com/AS3/2006/builtin"),ProtectedNamespace("com.hurlant.crypto.prng:ARC4"),StaticProtectedNs("com.hurlant.crypto.prng:ARC4")])
         add
         pushshort 255
         bitand
         getproperty MultinameL([PrivateNamespace(null,"1128"),PackageNamespace(""),PrivateNamespace(null,"2063"),PackageNamespace("com.hurlant.crypto.prng"),PackageInternalNs("com.hurlant.crypto.prng"),Namespace("http://adobe.com/AS3/2006/builtin"),ProtectedNamespace("com.hurlant.crypto.prng:ARC4"),StaticProtectedNs("com.hurlant.crypto.prng:ARC4")])
         returnvalue
         end ; code
         end ; body
         end ; method
      }
      
      public function getBlockSize() : uint
      {
         trait method Qname(PackageNamespace(""),"getBlockSize")
         dispid 0
         method
         name null
         returns Qname(PackageNamespace(""),"uint")
         
         body
         maxstack 1
         localcount 1
         initscopedepth 4
         maxscopedepth 5
         
         code
         getlocal_0
         pushscope
         pushbyte 1
         returnvalue
         end ; code
         end ; body
         end ; method
      }
      
      public function encrypt(param1:ByteArray) : void
      {
         trait method Qname(PackageNamespace(""),"encrypt")
         dispid 0
         method
         name null
         param Qname(PackageNamespace("flash.utils"),"ByteArray")
         returns Qname(PackageNamespace(""),"void")
         
         body
         maxstack 4
         localcount 4
         initscopedepth 4
         maxscopedepth 5
         
         code
         getlocal_0
         pushscope
         pushbyte 0
         convert_u
         setlocal_2
         jump ofs0026
         ofs000a:label
         getlocal_1
         getlocal_2
         convert_d
         dup
         increment
         convert_u
         setlocal_2
         setlocal_3
         getlocal_3
         getlocal_1
         getlocal_3
         getproperty MultinameL([PrivateNamespace(null,"1128"),PackageNamespace(""),PrivateNamespace(null,"2063"),PackageNamespace("com.hurlant.crypto.prng"),PackageInternalNs("com.hurlant.crypto.prng"),Namespace("http://adobe.com/AS3/2006/builtin"),ProtectedNamespace("com.hurlant.crypto.prng:ARC4"),StaticProtectedNs("com.hurlant.crypto.prng:ARC4")])
         getlocal_0
         callproperty Qname(PackageNamespace(""),"next") 0
         bitxor
         setproperty MultinameL([PrivateNamespace(null,"1128"),PackageNamespace(""),PrivateNamespace(null,"2063"),PackageNamespace("com.hurlant.crypto.prng"),PackageInternalNs("com.hurlant.crypto.prng"),Namespace("http://adobe.com/AS3/2006/builtin"),ProtectedNamespace("com.hurlant.crypto.prng:ARC4"),StaticProtectedNs("com.hurlant.crypto.prng:ARC4")])
         kill 3
         ofs0026:getlocal_2
         getlocal_1
         getproperty Qname(PackageNamespace(""),"length")
         iflt ofs000a
         returnvoid
         end ; code
         end ; body
         end ; method
      }
      
      public function decrypt(param1:ByteArray) : void
      {
         trait method Qname(PackageNamespace(""),"decrypt")
         dispid 0
         method
         name null
         param Qname(PackageNamespace("flash.utils"),"ByteArray")
         returns Qname(PackageNamespace(""),"void")
         
         body
         maxstack 2
         localcount 2
         initscopedepth 4
         maxscopedepth 5
         
         code
         getlocal_0
         pushscope
         getlocal_0
         getlocal_1
         callpropvoid Qname(PackageNamespace(""),"encrypt") 1
         returnvoid
         end ; code
         end ; body
         end ; method
      }
      
      public function dispose() : void
      {
         trait method Qname(PackageNamespace(""),"dispose")
         dispid 0
         method
         name null
         returns Qname(PackageNamespace(""),"void")
         
         body
         maxstack 4
         localcount 2
         initscopedepth 4
         maxscopedepth 5
         
         code
         getlocal_0
         pushscope
         pushbyte 0
         convert_u
         setlocal_1
         getlocal_0
         getproperty Qname(PrivateNamespace(null,"1128"),"S")
         pushnull
         ifeq ofs004b
         pushbyte 0
         convert_u
         setlocal_1
         jump ofs0031
         ofs0017:label
         getlocal_0
         getproperty Qname(PrivateNamespace(null,"1128"),"S")
         getlocal_1
         getlex Qname(PackageNamespace(""),"Math")
         callproperty Qname(PackageNamespace(""),"random") 0
         pushshort 256
         multiply
         setproperty MultinameL([PrivateNamespace(null,"1128"),PackageNamespace(""),PrivateNamespace(null,"2063"),PackageNamespace("com.hurlant.crypto.prng"),PackageInternalNs("com.hurlant.crypto.prng"),Namespace("http://adobe.com/AS3/2006/builtin"),ProtectedNamespace("com.hurlant.crypto.prng:ARC4"),StaticProtectedNs("com.hurlant.crypto.prng:ARC4")])
         getlocal_1
         increment
         convert_u
         setlocal_1
         ofs0031:getlocal_1
         getlocal_0
         getproperty Qname(PrivateNamespace(null,"1128"),"S")
         getproperty Qname(PackageNamespace(""),"length")
         iflt ofs0017
         getlocal_0
         getproperty Qname(PrivateNamespace(null,"1128"),"S")
         pushbyte 0
         setproperty Qname(PackageNamespace(""),"length")
         getlocal_0
         pushnull
         initproperty Qname(PrivateNamespace(null,"1128"),"S")
         ofs004b:getlocal_0
         pushbyte 0
         setproperty Qname(PrivateNamespace(null,"1128"),"i")
         getlocal_0
         pushbyte 0
         setproperty Qname(PrivateNamespace(null,"1128"),"j")
         getlex Qname(PackageNamespace("com.hurlant.util"),"Memory")
         callpropvoid Qname(PackageNamespace(""),"gc") 0
         returnvoid
         end ; code
         end ; body
         end ; method
      }
      
      public function toString() : String
      {
         trait method Qname(PackageNamespace(""),"toString")
         dispid 0
         method
         name null
         returns Qname(PackageNamespace(""),"String")
         
         body
         maxstack 1
         localcount 1
         initscopedepth 4
         maxscopedepth 5
         
         code
         getlocal_0
         pushscope
         pushstring "rc4"
         returnvalue
         end ; code
         end ; body
         end ; method
      }
   }
}
