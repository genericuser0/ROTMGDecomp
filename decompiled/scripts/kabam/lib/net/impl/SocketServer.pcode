package kabam.lib.net.impl
{
   import com.company.assembleegameclient.parameters.Parameters;
   import com.hurlant.crypto.symmetric.ICipher;
   import flash.events.Event;
   import flash.events.IOErrorEvent;
   import flash.events.ProgressEvent;
   import flash.events.SecurityErrorEvent;
   import flash.events.TimerEvent;
   import flash.net.Socket;
   import flash.utils.ByteArray;
   import flash.utils.Timer;
   import kabam.lib.net.api.MessageProvider;
   import org.osflash.signals.Signal;
   
   public class SocketServer
   {
      
      public static const MESSAGE_LENGTH_SIZE_IN_BYTES:int = 4;
      
      {
         method
         name null
         returns null
         
         body
         maxstack 2
         localcount 1
         initscopedepth 3
         maxscopedepth 4
         
         code
         getlocal_0
         pushscope
         findproperty Qname(PackageNamespace(""),"MESSAGE_LENGTH_SIZE_IN_BYTES")
         pushbyte 4
         initproperty Qname(PackageNamespace(""),"MESSAGE_LENGTH_SIZE_IN_BYTES")
         returnvoid
         end ; code
         end ; body
         end ; method
      }
      
      [Inject]
      public var messages:MessageProvider;
      
      [Inject]
      public var socket:Socket;
      
      [Inject]
      public var socketServerModel:SocketServerModel;
      
      public const connected:Signal;
      
      public const closed:Signal;
      
      public const error:Signal;
      
      public var delayTimer:Timer;
      
      private const unsentPlaceholder:Message;
      
      private const data:ByteArray;
      
      private var head:Message;
      
      private var tail:Message;
      
      private var messageLen:int = -1;
      
      private var outgoingCipher:ICipher;
      
      private var incomingCipher:ICipher;
      
      private var server:String;
      
      private var port:int;
      
      public function SocketServer()
      {
         method
         name null
         returns null
         
         body
         maxstack 3
         localcount 1
         initscopedepth 4
         maxscopedepth 5
         
         code
         getlocal_0
         pushscope
         getlocal_0
         findpropstrict Qname(PackageNamespace("org.osflash.signals"),"Signal")
         constructprop Qname(PackageNamespace("org.osflash.signals"),"Signal") 0
         initproperty Qname(PackageNamespace(""),"connected")
         getlocal_0
         findpropstrict Qname(PackageNamespace("org.osflash.signals"),"Signal")
         constructprop Qname(PackageNamespace("org.osflash.signals"),"Signal") 0
         initproperty Qname(PackageNamespace(""),"closed")
         getlocal_0
         findpropstrict Qname(PackageNamespace("org.osflash.signals"),"Signal")
         getlex Qname(PackageNamespace(""),"String")
         constructprop Qname(PackageNamespace("org.osflash.signals"),"Signal") 1
         initproperty Qname(PackageNamespace(""),"error")
         getlocal_0
         findpropstrict Qname(PackageNamespace("kabam.lib.net.impl"),"Message")
         pushbyte 0
         constructprop Qname(PackageNamespace("kabam.lib.net.impl"),"Message") 1
         initproperty Qname(PrivateNamespace(null,"503"),"unsentPlaceholder")
         getlocal_0
         findpropstrict Qname(PackageNamespace("flash.utils"),"ByteArray")
         constructprop Qname(PackageNamespace("flash.utils"),"ByteArray") 0
         initproperty Qname(PrivateNamespace(null,"503"),"data")
         getlocal_0
         getlocal_0
         getproperty Qname(PrivateNamespace(null,"503"),"unsentPlaceholder")
         initproperty Qname(PrivateNamespace(null,"503"),"head")
         getlocal_0
         getlocal_0
         getproperty Qname(PrivateNamespace(null,"503"),"unsentPlaceholder")
         initproperty Qname(PrivateNamespace(null,"503"),"tail")
         getlocal_0
         constructsuper 0
         returnvoid
         end ; code
         end ; body
         end ; method
      }
      
      public function setOutgoingCipher(param1:ICipher) : SocketServer
      {
         trait method Qname(PackageNamespace(""),"setOutgoingCipher")
         dispid 0
         method
         name null
         param Qname(PackageNamespace("com.hurlant.crypto.symmetric"),"ICipher")
         returns Qname(PackageNamespace("kabam.lib.net.impl"),"SocketServer")
         
         body
         maxstack 2
         localcount 2
         initscopedepth 4
         maxscopedepth 5
         
         code
         getlocal_0
         pushscope
         getlocal_0
         getlocal_1
         initproperty Qname(PrivateNamespace(null,"503"),"outgoingCipher")
         getlocal_0
         returnvalue
         end ; code
         end ; body
         end ; method
      }
      
      public function setIncomingCipher(param1:ICipher) : SocketServer
      {
         trait method Qname(PackageNamespace(""),"setIncomingCipher")
         dispid 0
         method
         name null
         param Qname(PackageNamespace("com.hurlant.crypto.symmetric"),"ICipher")
         returns Qname(PackageNamespace("kabam.lib.net.impl"),"SocketServer")
         
         body
         maxstack 2
         localcount 2
         initscopedepth 4
         maxscopedepth 5
         
         code
         getlocal_0
         pushscope
         getlocal_0
         getlocal_1
         initproperty Qname(PrivateNamespace(null,"503"),"incomingCipher")
         getlocal_0
         returnvalue
         end ; code
         end ; body
         end ; method
      }
      
      public function connect(param1:String, param2:int) : void
      {
         trait method Qname(PackageNamespace(""),"connect")
         dispid 0
         method
         name null
         param Qname(PackageNamespace(""),"String")
         param Qname(PackageNamespace(""),"int")
         returns Qname(PackageNamespace(""),"void")
         
         body
         maxstack 3
         localcount 3
         initscopedepth 4
         maxscopedepth 5
         
         code
         getlocal_0
         pushscope
         getlocal_0
         getlocal_1
         setproperty Qname(PrivateNamespace(null,"503"),"server")
         getlocal_0
         getlocal_2
         setproperty Qname(PrivateNamespace(null,"503"),"port")
         getlocal_0
         callpropvoid Qname(PrivateNamespace(null,"503"),"addListeners") 0
         getlocal_0
         pushbyte -1
         initproperty Qname(PrivateNamespace(null,"503"),"messageLen")
         getlocal_0
         getproperty Qname(PackageNamespace(""),"socketServerModel")
         getproperty Qname(PackageNamespace(""),"connectDelayMS")
         iffalse ofs002b
         getlocal_0
         callpropvoid Qname(PrivateNamespace(null,"503"),"connectWithDelay") 0
         jump ofs0035
         ofs002b:getlocal_0
         getproperty Qname(PackageNamespace(""),"socket")
         getlocal_1
         getlocal_2
         callpropvoid Qname(PackageNamespace(""),"connect") 2
         ofs0035:returnvoid
         end ; code
         end ; body
         end ; method
      }
      
      private function addListeners() : void
      {
         trait method Qname(PrivateNamespace(null,"503"),"addListeners")
         dispid 0
         method
         name null
         returns Qname(PackageNamespace(""),"void")
         
         body
         maxstack 3
         localcount 1
         initscopedepth 4
         maxscopedepth 5
         
         code
         getlocal_0
         pushscope
         getlocal_0
         getproperty Qname(PackageNamespace(""),"socket")
         getlex Qname(PackageNamespace("flash.events"),"Event")
         getproperty Qname(PackageNamespace(""),"CONNECT")
         getlocal_0
         getproperty Qname(PrivateNamespace(null,"503"),"onConnect")
         callpropvoid Qname(PackageNamespace(""),"addEventListener") 2
         getlocal_0
         getproperty Qname(PackageNamespace(""),"socket")
         getlex Qname(PackageNamespace("flash.events"),"Event")
         getproperty Qname(PackageNamespace(""),"CLOSE")
         getlocal_0
         getproperty Qname(PrivateNamespace(null,"503"),"onClose")
         callpropvoid Qname(PackageNamespace(""),"addEventListener") 2
         getlocal_0
         getproperty Qname(PackageNamespace(""),"socket")
         getlex Qname(PackageNamespace("flash.events"),"ProgressEvent")
         getproperty Qname(PackageNamespace(""),"SOCKET_DATA")
         getlocal_0
         getproperty Qname(PrivateNamespace(null,"503"),"onSocketData")
         callpropvoid Qname(PackageNamespace(""),"addEventListener") 2
         getlocal_0
         getproperty Qname(PackageNamespace(""),"socket")
         getlex Qname(PackageNamespace("flash.events"),"IOErrorEvent")
         getproperty Qname(PackageNamespace(""),"IO_ERROR")
         getlocal_0
         getproperty Qname(PrivateNamespace(null,"503"),"onIOError")
         callpropvoid Qname(PackageNamespace(""),"addEventListener") 2
         getlocal_0
         getproperty Qname(PackageNamespace(""),"socket")
         getlex Qname(PackageNamespace("flash.events"),"SecurityErrorEvent")
         getproperty Qname(PackageNamespace(""),"SECURITY_ERROR")
         getlocal_0
         getproperty Qname(PrivateNamespace(null,"503"),"onSecurityError")
         callpropvoid Qname(PackageNamespace(""),"addEventListener") 2
         returnvoid
         end ; code
         end ; body
         end ; method
      }
      
      private function connectWithDelay() : void
      {
         trait method Qname(PrivateNamespace(null,"503"),"connectWithDelay")
         dispid 0
         method
         name null
         returns Qname(PackageNamespace(""),"void")
         
         body
         maxstack 4
         localcount 1
         initscopedepth 4
         maxscopedepth 5
         
         code
         getlocal_0
         pushscope
         getlocal_0
         findpropstrict Qname(PackageNamespace("flash.utils"),"Timer")
         getlocal_0
         getproperty Qname(PackageNamespace(""),"socketServerModel")
         getproperty Qname(PackageNamespace(""),"connectDelayMS")
         pushbyte 1
         constructprop Qname(PackageNamespace("flash.utils"),"Timer") 2
         initproperty Qname(PackageNamespace(""),"delayTimer")
         getlocal_0
         getproperty Qname(PackageNamespace(""),"delayTimer")
         getlex Qname(PackageNamespace("flash.events"),"TimerEvent")
         getproperty Qname(PackageNamespace(""),"TIMER_COMPLETE")
         getlocal_0
         getproperty Qname(PrivateNamespace(null,"503"),"onTimerComplete")
         callpropvoid Qname(PackageNamespace(""),"addEventListener") 2
         getlocal_0
         getproperty Qname(PackageNamespace(""),"delayTimer")
         callpropvoid Qname(PackageNamespace(""),"start") 0
         returnvoid
         end ; code
         end ; body
         end ; method
      }
      
      private function onTimerComplete(param1:TimerEvent) : void
      {
         trait method Qname(PrivateNamespace(null,"503"),"onTimerComplete")
         dispid 0
         method
         name null
         param Qname(PackageNamespace("flash.events"),"TimerEvent")
         returns Qname(PackageNamespace(""),"void")
         
         body
         maxstack 3
         localcount 2
         initscopedepth 4
         maxscopedepth 5
         
         code
         getlocal_0
         pushscope
         getlocal_0
         getproperty Qname(PackageNamespace(""),"delayTimer")
         getlex Qname(PackageNamespace("flash.events"),"TimerEvent")
         getproperty Qname(PackageNamespace(""),"TIMER_COMPLETE")
         getlocal_0
         getproperty Qname(PrivateNamespace(null,"503"),"onTimerComplete")
         callpropvoid Qname(PackageNamespace(""),"removeEventListener") 2
         getlocal_0
         getproperty Qname(PackageNamespace(""),"socket")
         getlocal_0
         getproperty Qname(PrivateNamespace(null,"503"),"server")
         getlocal_0
         getproperty Qname(PrivateNamespace(null,"503"),"port")
         callpropvoid Qname(PackageNamespace(""),"connect") 2
         returnvoid
         end ; code
         end ; body
         end ; method
      }
      
      public function disconnect() : void
      {
         trait method Qname(PackageNamespace(""),"disconnect")
         dispid 0
         method
         name null
         returns Qname(PackageNamespace(""),"void")
         
         body
         maxstack 1
         localcount 1
         initscopedepth 4
         maxscopedepth 5
         
         code
         getlocal_0
         pushscope
         getlocal_0
         getproperty Qname(PackageNamespace(""),"socket")
         getproperty Qname(PackageNamespace(""),"connected")
         iffalse ofs0015
         getlocal_0
         getproperty Qname(PackageNamespace(""),"socket")
         callpropvoid Qname(PackageNamespace(""),"close") 0
         ofs0015:getlocal_0
         callpropvoid Qname(PrivateNamespace(null,"503"),"removeListeners") 0
         getlocal_0
         getproperty Qname(PackageNamespace(""),"closed")
         callpropvoid Qname(PackageNamespace(""),"dispatch") 0
         returnvoid
         end ; code
         end ; body
         end ; method
      }
      
      private function removeListeners() : void
      {
         trait method Qname(PrivateNamespace(null,"503"),"removeListeners")
         dispid 0
         method
         name null
         returns Qname(PackageNamespace(""),"void")
         
         body
         maxstack 3
         localcount 1
         initscopedepth 4
         maxscopedepth 5
         
         code
         getlocal_0
         pushscope
         getlocal_0
         getproperty Qname(PackageNamespace(""),"socket")
         getlex Qname(PackageNamespace("flash.events"),"Event")
         getproperty Qname(PackageNamespace(""),"CONNECT")
         getlocal_0
         getproperty Qname(PrivateNamespace(null,"503"),"onConnect")
         callpropvoid Qname(PackageNamespace(""),"removeEventListener") 2
         getlocal_0
         getproperty Qname(PackageNamespace(""),"socket")
         getlex Qname(PackageNamespace("flash.events"),"Event")
         getproperty Qname(PackageNamespace(""),"CLOSE")
         getlocal_0
         getproperty Qname(PrivateNamespace(null,"503"),"onClose")
         callpropvoid Qname(PackageNamespace(""),"removeEventListener") 2
         getlocal_0
         getproperty Qname(PackageNamespace(""),"socket")
         getlex Qname(PackageNamespace("flash.events"),"ProgressEvent")
         getproperty Qname(PackageNamespace(""),"SOCKET_DATA")
         getlocal_0
         getproperty Qname(PrivateNamespace(null,"503"),"onSocketData")
         callpropvoid Qname(PackageNamespace(""),"removeEventListener") 2
         getlocal_0
         getproperty Qname(PackageNamespace(""),"socket")
         getlex Qname(PackageNamespace("flash.events"),"IOErrorEvent")
         getproperty Qname(PackageNamespace(""),"IO_ERROR")
         getlocal_0
         getproperty Qname(PrivateNamespace(null,"503"),"onIOError")
         callpropvoid Qname(PackageNamespace(""),"removeEventListener") 2
         getlocal_0
         getproperty Qname(PackageNamespace(""),"socket")
         getlex Qname(PackageNamespace("flash.events"),"SecurityErrorEvent")
         getproperty Qname(PackageNamespace(""),"SECURITY_ERROR")
         getlocal_0
         getproperty Qname(PrivateNamespace(null,"503"),"onSecurityError")
         callpropvoid Qname(PackageNamespace(""),"removeEventListener") 2
         returnvoid
         end ; code
         end ; body
         end ; method
      }
      
      public function sendMessage(param1:Message) : void
      {
         trait method Qname(PackageNamespace(""),"sendMessage")
         dispid 0
         method
         name null
         param Qname(PackageNamespace("kabam.lib.net.impl"),"Message")
         returns Qname(PackageNamespace(""),"void")
         
         body
         maxstack 2
         localcount 2
         initscopedepth 4
         maxscopedepth 5
         
         code
         getlocal_0
         pushscope
         getlocal_0
         getproperty Qname(PrivateNamespace(null,"503"),"tail")
         getlocal_1
         setproperty Qname(PackageNamespace(""),"next")
         getlocal_0
         getlocal_1
         initproperty Qname(PrivateNamespace(null,"503"),"tail")
         getlocal_0
         getproperty Qname(PackageNamespace(""),"socket")
         getproperty Qname(PackageNamespace(""),"connected")
         coerce_a
         dup
         iffalse ofs0023
         pop
         getlocal_0
         callproperty Qname(PrivateNamespace(null,"503"),"sendPendingMessages") 0
         coerce_a
         ofs0023:pop
         returnvoid
         end ; code
         end ; body
         end ; method
      }
      
      private function sendPendingMessages() : void
      {
         trait method Qname(PrivateNamespace(null,"503"),"sendPendingMessages")
         dispid 0
         method
         name null
         returns Qname(PackageNamespace(""),"void")
         
         body
         maxstack 4
         localcount 4
         initscopedepth 4
         maxscopedepth 5
         
         code
         getlocal_0
         pushscope
         getlocal_0
         getproperty Qname(PrivateNamespace(null,"503"),"head")
         getproperty Qname(PackageNamespace(""),"next")
         coerce Qname(PackageNamespace("kabam.lib.net.impl"),"Message")
         setlocal_1
         getlocal_1
         coerce Qname(PackageNamespace("kabam.lib.net.impl"),"Message")
         setlocal_2
         jump ofs008a
         ofs0016:label
         getlocal_0
         getproperty Qname(PrivateNamespace(null,"503"),"data")
         callpropvoid Qname(PackageNamespace(""),"clear") 0
         getlocal_2
         getlocal_0
         getproperty Qname(PrivateNamespace(null,"503"),"data")
         callpropvoid Qname(PackageNamespace(""),"writeToOutput") 1
         getlocal_0
         getproperty Qname(PrivateNamespace(null,"503"),"data")
         pushbyte 0
         setproperty Qname(PackageNamespace(""),"position")
         getlocal_0
         getproperty Qname(PrivateNamespace(null,"503"),"outgoingCipher")
         pushnull
         ifeq ofs004f
         getlocal_0
         getproperty Qname(PrivateNamespace(null,"503"),"outgoingCipher")
         getlocal_0
         getproperty Qname(PrivateNamespace(null,"503"),"data")
         callpropvoid Qname(Namespace("com.hurlant.crypto.symmetric:ICipher"),"encrypt") 1
         getlocal_0
         getproperty Qname(PrivateNamespace(null,"503"),"data")
         pushbyte 0
         setproperty Qname(PackageNamespace(""),"position")
         ofs004f:getlocal_0
         getproperty Qname(PackageNamespace(""),"socket")
         getlocal_0
         getproperty Qname(PrivateNamespace(null,"503"),"data")
         getproperty Qname(PackageNamespace(""),"bytesAvailable")
         pushbyte 5
         add
         callpropvoid Qname(PackageNamespace(""),"writeInt") 1
         getlocal_0
         getproperty Qname(PackageNamespace(""),"socket")
         getlocal_2
         getproperty Qname(PackageNamespace(""),"id")
         callpropvoid Qname(PackageNamespace(""),"writeByte") 1
         getlocal_0
         getproperty Qname(PackageNamespace(""),"socket")
         getlocal_0
         getproperty Qname(PrivateNamespace(null,"503"),"data")
         callpropvoid Qname(PackageNamespace(""),"writeBytes") 1
         getlocal_2
         callpropvoid Qname(PackageNamespace(""),"consume") 0
         getlocal_2
         getproperty Qname(PackageNamespace(""),"next")
         coerce Qname(PackageNamespace("kabam.lib.net.impl"),"Message")
         setlocal_2
         ofs008a:getlocal_2
         iftrue ofs0016
         getlocal_0
         getproperty Qname(PackageNamespace(""),"socket")
         callpropvoid Qname(PackageNamespace(""),"flush") 0
         getlocal_0
         getproperty Qname(PrivateNamespace(null,"503"),"unsentPlaceholder")
         pushnull
         setproperty Qname(PackageNamespace(""),"next")
         getlocal_0
         getproperty Qname(PrivateNamespace(null,"503"),"unsentPlaceholder")
         pushnull
         setproperty Qname(PackageNamespace(""),"prev")
         getlocal_0
         getlocal_0
         getlocal_0
         getproperty Qname(PrivateNamespace(null,"503"),"unsentPlaceholder")
         dup
         setlocal_3
         initproperty Qname(PrivateNamespace(null,"503"),"tail")
         getlocal_3
         kill 3
         initproperty Qname(PrivateNamespace(null,"503"),"head")
         returnvoid
         end ; code
         end ; body
         end ; method
      }
      
      private function onConnect(param1:Event) : void
      {
         trait method Qname(PrivateNamespace(null,"503"),"onConnect")
         dispid 0
         method
         name null
         param Qname(PackageNamespace("flash.events"),"Event")
         returns Qname(PackageNamespace(""),"void")
         
         body
         maxstack 1
         localcount 2
         initscopedepth 4
         maxscopedepth 5
         
         code
         getlocal_0
         pushscope
         getlocal_0
         callpropvoid Qname(PrivateNamespace(null,"503"),"sendPendingMessages") 0
         getlocal_0
         getproperty Qname(PackageNamespace(""),"connected")
         callpropvoid Qname(PackageNamespace(""),"dispatch") 0
         returnvoid
         end ; code
         end ; body
         end ; method
      }
      
      private function onClose(param1:Event) : void
      {
         trait method Qname(PrivateNamespace(null,"503"),"onClose")
         dispid 0
         method
         name null
         param Qname(PackageNamespace("flash.events"),"Event")
         returns Qname(PackageNamespace(""),"void")
         
         body
         maxstack 1
         localcount 2
         initscopedepth 4
         maxscopedepth 5
         
         code
         getlocal_0
         pushscope
         getlocal_0
         getproperty Qname(PackageNamespace(""),"closed")
         callpropvoid Qname(PackageNamespace(""),"dispatch") 0
         returnvoid
         end ; code
         end ; body
         end ; method
      }
      
      private function onIOError(param1:IOErrorEvent) : void
      {
         trait method Qname(PrivateNamespace(null,"503"),"onIOError")
         dispid 0
         method
         name null
         param Qname(PackageNamespace("flash.events"),"IOErrorEvent")
         returns Qname(PackageNamespace(""),"void")
         
         body
         maxstack 3
         localcount 3
         initscopedepth 4
         maxscopedepth 5
         
         code
         getlocal_0
         pushscope
         getlocal_0
         pushstring "Socket-Server IO Error: {0}"
         getlocal_1
         getproperty Qname(PackageNamespace(""),"text")
         newarray 1
         callproperty Qname(PrivateNamespace(null,"503"),"parseString") 2
         coerce_s
         setlocal_2
         getlocal_0
         getproperty Qname(PackageNamespace(""),"error")
         getlocal_2
         callpropvoid Qname(PackageNamespace(""),"dispatch") 1
         getlocal_0
         getproperty Qname(PackageNamespace(""),"closed")
         callpropvoid Qname(PackageNamespace(""),"dispatch") 0
         returnvoid
         end ; code
         end ; body
         end ; method
      }
      
      private function onSecurityError(param1:SecurityErrorEvent) : void
      {
         trait method Qname(PrivateNamespace(null,"503"),"onSecurityError")
         dispid 0
         method
         name null
         param Qname(PackageNamespace("flash.events"),"SecurityErrorEvent")
         returns Qname(PackageNamespace(""),"void")
         
         body
         maxstack 3
         localcount 3
         initscopedepth 4
         maxscopedepth 5
         
         code
         getlocal_0
         pushscope
         getlocal_0
         pushstring "Socket-Server Security: {0}. Please open port "
         getlex Qname(PackageNamespace("com.company.assembleegameclient.parameters"),"Parameters")
         getproperty Qname(PackageNamespace(""),"PORT")
         add
         pushstring " in your firewall and/or router settings and try again"
         add
         getlocal_1
         getproperty Qname(PackageNamespace(""),"text")
         newarray 1
         callproperty Qname(PrivateNamespace(null,"503"),"parseString") 2
         coerce_s
         setlocal_2
         getlocal_0
         getproperty Qname(PackageNamespace(""),"error")
         getlocal_2
         callpropvoid Qname(PackageNamespace(""),"dispatch") 1
         getlocal_0
         getproperty Qname(PackageNamespace(""),"closed")
         callpropvoid Qname(PackageNamespace(""),"dispatch") 0
         returnvoid
         end ; code
         end ; body
         end ; method
      }
      
      private function onSocketData(param1:ProgressEvent = null) : void
      {
         trait method Qname(PrivateNamespace(null,"503"),"onSocketData")
         dispid 0
         method
         name null
         flag HAS_OPTIONAL
         flag NEED_ACTIVATION
         param Qname(PackageNamespace("flash.events"),"ProgressEvent")
         optional null
         returns Qname(PackageNamespace(""),"void")
         
         body
         maxstack 5
         localcount 4
         initscopedepth 5
         maxscopedepth 10
         try from ofs0065 to ofs0072 target ofs0076 type Qname(PackageNamespace(""),"Error") name Qname(PackageNamespace(""),"e")
         try from ofs016f to ofs017b target ofs017f type Qname(PackageNamespace(""),"Error") name Qname(PackageNamespace(""),"error")
         
         code
         getlocal_0
         pushscope
         newactivation
         dup
         setlocal_2
         pushscope
         getscopeobject 1
         pushbyte 0
         convert_u
         setslot 2
         getscopeobject 1
         pushnull
         coerce Qname(PackageNamespace("kabam.lib.net.impl"),"Message")
         setslot 3
         getscopeobject 1
         pushnull
         coerce Qname(PackageNamespace("flash.utils"),"ByteArray")
         setslot 4
         getscopeobject 1
         pushnull
         coerce_s
         setslot 5
         getscopeobject 1
         getlocal_1
         setslot 1
         jump ofs01b6
         ofs002c:label
         getlocal_0
         getproperty Qname(PackageNamespace(""),"socket")
         pushnull
         equals
         dup
         iftrue ofs0041
         pop
         getlocal_0
         getproperty Qname(PackageNamespace(""),"socket")
         getproperty Qname(PackageNamespace(""),"connected")
         not
         ofs0041:iffalse ofs0049
         jump ofs01ba
         ofs0049:getlocal_0
         getproperty Qname(PrivateNamespace(null,"503"),"messageLen")
         pushbyte -1
         ifne ofs00c2
         getlocal_0
         getproperty Qname(PackageNamespace(""),"socket")
         getproperty Qname(PackageNamespace(""),"bytesAvailable")
         pushbyte 4
         ifnlt ofs0065
         jump ofs01ba
         ofs0065:getlocal_0
         getlocal_0
         getproperty Qname(PackageNamespace(""),"socket")
         callproperty Qname(PackageNamespace(""),"readInt") 0
         initproperty Qname(PrivateNamespace(null,"503"),"messageLen")
         ofs0072:jump ofs00c2
         ofs0076:getlocal_0
         pushscope
         getlocal_2
         pushscope
         newcatch 0
         dup
         setlocal_3
         dup
         pushscope
         swap
         setslot 1
         getscopeobject 1
         findpropstrict Qname(PrivateNamespace(null,"503"),"parseString")
         pushstring "Socket-Server Data Error: {0}: {1}"
         getscopeobject 2
         getslot 1
         getproperty Qname(PackageNamespace(""),"name")
         getscopeobject 2
         getslot 1
         getproperty Qname(PackageNamespace(""),"message")
         newarray 2
         callproperty Qname(PrivateNamespace(null,"503"),"parseString") 2
         coerce_s
         setslot 5
         getlex Qname(PackageNamespace(""),"error")
         getscopeobject 1
         getslot 5
         callpropvoid Qname(PackageNamespace(""),"dispatch") 1
         findproperty Qname(PrivateNamespace(null,"503"),"messageLen")
         pushbyte -1
         initproperty Qname(PrivateNamespace(null,"503"),"messageLen")
         kill 3
         popscope
         kill 3
         jump ofs01ba
         popscope
         kill 3
         ofs00c2:getlocal_0
         getproperty Qname(PackageNamespace(""),"socket")
         getproperty Qname(PackageNamespace(""),"bytesAvailable")
         getlocal_0
         getproperty Qname(PrivateNamespace(null,"503"),"messageLen")
         getlex Qname(PackageNamespace(""),"MESSAGE_LENGTH_SIZE_IN_BYTES")
         subtract
         ifnlt ofs00db
         jump ofs01ba
         ofs00db:getscopeobject 1
         getlocal_0
         getproperty Qname(PackageNamespace(""),"socket")
         callproperty Qname(PackageNamespace(""),"readUnsignedByte") 0
         convert_u
         setslot 2
         getscopeobject 1
         getlocal_0
         getproperty Qname(PackageNamespace(""),"messages")
         getscopeobject 1
         getslot 2
         callproperty Qname(Namespace("kabam.lib.net.api:MessageProvider"),"require") 1
         coerce Qname(PackageNamespace("kabam.lib.net.impl"),"Message")
         setslot 3
         getscopeobject 1
         findpropstrict Qname(PackageNamespace("flash.utils"),"ByteArray")
         constructprop Qname(PackageNamespace("flash.utils"),"ByteArray") 0
         coerce Qname(PackageNamespace("flash.utils"),"ByteArray")
         setslot 4
         getlocal_0
         getproperty Qname(PrivateNamespace(null,"503"),"messageLen")
         pushbyte 5
         subtract
         pushbyte 0
         ifngt ofs012c
         getlocal_0
         getproperty Qname(PackageNamespace(""),"socket")
         getscopeobject 1
         getslot 4
         pushbyte 0
         getlocal_0
         getproperty Qname(PrivateNamespace(null,"503"),"messageLen")
         pushbyte 5
         subtract
         callpropvoid Qname(PackageNamespace(""),"readBytes") 3
         ofs012c:getscopeobject 1
         getslot 4
         pushbyte 0
         setproperty Qname(PackageNamespace(""),"position")
         getlocal_0
         getproperty Qname(PrivateNamespace(null,"503"),"incomingCipher")
         pushnull
         ifeq ofs0153
         getlocal_0
         getproperty Qname(PrivateNamespace(null,"503"),"incomingCipher")
         getscopeobject 1
         getslot 4
         callpropvoid Qname(Namespace("com.hurlant.crypto.symmetric:ICipher"),"decrypt") 1
         getscopeobject 1
         getslot 4
         pushbyte 0
         setproperty Qname(PackageNamespace(""),"position")
         ofs0153:getlocal_0
         pushbyte -1
         initproperty Qname(PrivateNamespace(null,"503"),"messageLen")
         getscopeobject 1
         getslot 3
         pushnull
         ifne ofs016f
         getlocal_0
         pushstring "Socket-Server Protocol Error: Unknown message"
         callpropvoid Qname(PrivateNamespace(null,"503"),"logErrorAndClose") 1
         jump ofs01ba
         ofs016f:getscopeobject 1
         getslot 3
         getscopeobject 1
         getslot 4
         callpropvoid Qname(PackageNamespace(""),"parseFromInput") 1
         ofs017b:jump ofs01ae
         ofs017f:getlocal_0
         pushscope
         getlocal_2
         pushscope
         newcatch 1
         dup
         setlocal_3
         dup
         pushscope
         swap
         setslot 1
         findpropstrict Qname(PrivateNamespace(null,"503"),"logErrorAndClose")
         pushstring "Socket-Server Protocol Error: {0}"
         getscopeobject 2
         getslot 1
         callproperty Multiname("toString",[PrivateNamespace(null,"503"),PackageNamespace(""),PackageNamespace("kabam.lib.net.impl"),PrivateNamespace(null,"1533"),PackageInternalNs("kabam.lib.net.impl"),Namespace("http://adobe.com/AS3/2006/builtin"),ProtectedNamespace("kabam.lib.net.impl:SocketServer"),StaticProtectedNs("kabam.lib.net.impl:SocketServer")]) 0
         newarray 1
         callpropvoid Qname(PrivateNamespace(null,"503"),"logErrorAndClose") 2
         kill 3
         popscope
         kill 3
         jump ofs01ba
         popscope
         kill 3
         ofs01ae:getscopeobject 1
         getslot 3
         callpropvoid Qname(PackageNamespace(""),"consume") 0
         ofs01b6:jump ofs002c
         ofs01ba:returnvoid
         end ; code
         end ; body
         end ; method
      }
      
      private function logErrorAndClose(param1:String, param2:Array = null) : void
      {
         trait method Qname(PrivateNamespace(null,"503"),"logErrorAndClose")
         dispid 0
         method
         name null
         flag HAS_OPTIONAL
         param Qname(PackageNamespace(""),"String")
         param Qname(PackageNamespace(""),"Array")
         optional null
         returns Qname(PackageNamespace(""),"void")
         
         body
         maxstack 4
         localcount 3
         initscopedepth 4
         maxscopedepth 5
         
         code
         getlocal_0
         pushscope
         getlocal_0
         getproperty Qname(PackageNamespace(""),"error")
         getlocal_0
         getlocal_1
         getlocal_2
         callproperty Qname(PrivateNamespace(null,"503"),"parseString") 2
         callpropvoid Qname(PackageNamespace(""),"dispatch") 1
         getlocal_0
         callpropvoid Qname(PackageNamespace(""),"disconnect") 0
         returnvoid
         end ; code
         end ; body
         end ; method
      }
      
      private function parseString(param1:String, param2:Array) : String
      {
         trait method Qname(PrivateNamespace(null,"503"),"parseString")
         dispid 0
         method
         name null
         param Qname(PackageNamespace(""),"String")
         param Qname(PackageNamespace(""),"Array")
         returns Qname(PackageNamespace(""),"String")
         
         body
         maxstack 4
         localcount 5
         initscopedepth 4
         maxscopedepth 5
         
         code
         getlocal_0
         pushscope
         getlocal_2
         getproperty Qname(PackageNamespace(""),"length")
         convert_i
         setlocal_3
         pushbyte 0
         setlocal 4
         jump ofs002e
         ofs0010:label
         getlocal_1
         pushstring "{"
         getlocal 4
         add
         pushstring "}"
         add
         getlocal_2
         getlocal 4
         getproperty MultinameL([PrivateNamespace(null,"503"),PackageNamespace(""),PackageNamespace("kabam.lib.net.impl"),PrivateNamespace(null,"1533"),PackageInternalNs("kabam.lib.net.impl"),Namespace("http://adobe.com/AS3/2006/builtin"),ProtectedNamespace("kabam.lib.net.impl:SocketServer"),StaticProtectedNs("kabam.lib.net.impl:SocketServer")])
         callproperty Qname(Namespace("http://adobe.com/AS3/2006/builtin"),"replace") 2
         coerce_s
         setlocal_1
         inclocal_i 4
         ofs002e:getlocal 4
         getlocal_3
         iflt ofs0010
         getlocal_1
         returnvalue
         end ; code
         end ; body
         end ; method
      }
      
      public function isConnected() : Boolean
      {
         trait method Qname(PackageNamespace(""),"isConnected")
         dispid 0
         method
         name null
         returns Qname(PackageNamespace(""),"Boolean")
         
         body
         maxstack 1
         localcount 1
         initscopedepth 4
         maxscopedepth 5
         
         code
         getlocal_0
         pushscope
         getlocal_0
         getproperty Qname(PackageNamespace(""),"socket")
         getproperty Qname(PackageNamespace(""),"connected")
         returnvalue
         end ; code
         end ; body
         end ; method
      }
   }
}
